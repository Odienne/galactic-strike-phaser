import{r as e}from"./phaser-y5S3hZEA.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var t=e();class o extends t.Scene{constructor(){super("Boot")}preload(){}create(){this.scene.start("Game")}}class s{constructor(e){this.scene=e,this.laser1=this.scene.add.video(125,265,"laser1").setOrigin(0,0).setDepth(-400).setVisible(!1).play(!0),this.laser2=this.scene.add.video(125,265,"laser2").setOrigin(0,0).setDepth(-400).setVisible(!1).play(!0),this.laser3=this.scene.add.video(125,265,"laser3").setOrigin(0,0).setDepth(-400).setVisible(!1).play(!0),this.laser1.once("play",(()=>{this.laser1.setDisplaySize(870,510)})),this.laser2.once("play",(()=>{this.laser2.setDisplaySize(870,510).stop()})),this.laser3.once("play",(()=>{this.laser3.setDisplaySize(870,510).stop()})),this.playVideo()}playVideo(){switch(void 0!==this.currentVideo&&(this.currentVideo.setDepth(-500),this.currentVideo.stop()),window.currentWeapon){case 1:default:this.currentVideo=this.laser1;break;case 2:this.currentVideo=this.laser2;break;case 3:this.currentVideo=this.laser3}try{this.currentVideo.setVisible(!0),this.currentVideo.setDepth(-400),this.currentVideo.play(!0)}catch(e){console.warn("Video play failed:",e)}}}class a extends Phaser.Scene{constructor(){super("Game")}preload(){this.load.image("bg1","assets/bg1.png"),this.load.image("bg2","assets/bg2.png"),this.load.image("bg3","assets/bg3.png"),this.load.video("laser1","assets/videos/laser1.webm",!0),this.load.video("laser2","assets/videos/laser2.webm",!0),this.load.video("laser3","assets/videos/laser3.webm",!0),this.load.video("laser3","assets/videos/laser3.webm",!0),this.load.audio("change-weapon","assets/sfx/01-change-weapon.mp3"),this.loadFonts()}create(){this.changeWeaponAudio=this.sound.add("change-weapon"),this.weaponsData=window.getWeaponInfos(),this.weaponVideoManager=new s(this),this.initCooldownDisplay(),this.setBackgroundImage(),this.title=this.add.text(980,60,this.weaponsData[window.currentWeapon].name,{align:"center",fontFamily:"HemiHead",fontSize:"60px",color:"#ffffff",padding:10}).setOrigin(.5,.5).setDepth(1e3),this.setWeaponTitle(),this.setupInput()}update(e,t){Object.keys(this.cooldownRects).forEach((e=>{const t=this.cooldownRects[e],o=t.weaponId,s=window.getWeapon(o),a=Date.now()-s.lastUsed,n=Phaser.Math.Clamp(a/s.cooldown,0,1);s.baseCooldown<a?t.text.isBlinking||(t.text.isBlinking=!0,this.tweens.add({targets:t.text,alpha:{from:1,to:.6},color:{from:16711680,to:16777215},yoyo:!0,duration:200,ease:"Sine.easeInOut",onComplete:()=>{t.text.setAlpha(1)}}),this.tweens.add({targets:t.text,scale:2,yoyo:!0,duration:100,onComplete:()=>{t.text.setScale(1)}}),window.resetWeaponCooldown(o)):(t.text.isBlinking=!1,this.tweens.killTweensOf(t.text),t.text.setAlpha(.4).setScale(.92)),t.rect.width=t.fullWidth*n,window.currentWeapon===parseInt(e)?this.cooldownRects[e].bgRect.setAlpha(.6):this.cooldownRects[e].bgRect.setAlpha(0)}))}setupInput(){["ONE","TWO","THREE"].forEach(((e,t)=>{this.input.keyboard.on(`keydown-${e}`,(()=>{t+1!==window.currentWeapon&&(this.changeWeaponAudio.play(),window.setWeapon(t+1),this.setVideo(),this.setBackgroundImage(),this.setWeaponTitle())}))})),this.input.keyboard.on("keydown-SPACE",(()=>{window.isWeaponOffCoolDown(window.currentWeapon)&&window.updateWeaponCooldown(window.currentWeapon)}))}loadFonts(){this.loadFont("HemiHead","assets/fonts/HemiHead/hemihead.otf")}loadFont(e,t){new FontFace(e,`url(${t})`).load().then((function(e){document.fonts.add(e)})).catch((function(e){return e}))}preloadAudio(){}setBackgroundImage(){switch(window.currentWeapon){case 1:default:this.add.image(0,0,"bg1").setOrigin(0,0).setDisplaySize(1920,1080).setDepth(100);break;case 2:this.add.image(0,0,"bg2").setOrigin(0,0).setDisplaySize(1920,1080).setDepth(100);break;case 3:this.add.image(0,0,"bg3").setOrigin(0,0).setDisplaySize(1920,1080).setDepth(100)}}setWeaponTitle(){this.title.text=this.weaponsData[window.currentWeapon].name}setVideo(){this.weaponVideoManager.playVideo()}initCooldownDisplay(){this.cooldownRects={};const e=window.getWeaponInfos(),t=640;Object.keys(e).forEach(((o,s)=>{const a=e[o],n=t*(o-1),i=this.add.rectangle(n,952,t,128,a.fillColor).setAlpha(.1).setDepth(890).setOrigin(0,0),r=this.add.rectangle(n,1067.2,t,12.8,a.fillColor).setAlpha(1).setDepth(900).setOrigin(0,0);this.cooldownRects[o]={rect:r,bgRect:i,fullWidth:t,cooldown:a.cooldown,weaponId:o};const d=n+320;this.cooldownRects[o].text=this.add.text(d,1013,a.name,{align:"center",fontFamily:"HemiHead",fontSize:"38px",color:"#ffffff",padding:10}).setOrigin(.5,.5).setDepth(1e3)}))}}class n extends t.Scene{constructor(){super("Preloader")}init(){this.add.rectangle(512,384,468,32).setStrokeStyle(1,16777215);const e=this.add.rectangle(282,384,4,28,16777215);this.load.on("progress",(t=>{e.width=4+460*t}))}preload(){this.load.setPath("assets"),this.load.image("logo","logo.png")}create(){this.scene.start("MainMenu")}}const i={type:Phaser.WEBGL,width:1920,height:1080,parent:"game-container",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:1920,height:1080},scene:[o,n,a],fps:{target:60,forceSetTimeOut:!0},render:{antialias:!0,roundPixels:!1,maxTextures:20,batchSize:4096,clearBeforeRender:!0,failIfMajorPerformanceCaveat:!1,transparent:!1}};document.addEventListener("DOMContentLoaded",(()=>{new t.Game({...i,parent:"game-container"})}));let r={1:{name:"LASER V1",fillColor:"0xff0000",cooldown:0,baseCooldown:800,lastUsed:null},2:{name:"PLASMA V3",fillColor:"0xe66eff",cooldown:0,baseCooldown:1e4,lastUsed:null},3:{name:"SUPERNOVA V9",fillColor:"0xff9300",cooldown:0,baseCooldown:3e4,lastUsed:null}};window.currentWeapon=1,window.updateWeaponCooldown=e=>{switch(parseInt(e)){case 1:r[1].cooldown=r[1].baseCooldown,r[1].lastUsed=Date.now();break;case 2:r[2].cooldown=r[2].baseCooldown,r[2].lastUsed=Date.now();break;case 3:r[3].cooldown=r[3].baseCooldown,r[3].lastUsed=Date.now()}},window.resetWeaponCooldown=e=>{switch(parseInt(e)){case 1:r[1].cooldown=0;break;case 2:r[2].cooldown=0;break;case 3:r[3].cooldown=0}},window.setWeapon=e=>{window.currentWeapon=e,window.sendToQt(JSON.stringify({weaponId:e}))},window.isWeaponOffCoolDown=e=>r[e].cooldown<=0,window.getWeaponInfos=()=>r,window.getWeapon=e=>r[e],window.setLanguage=e=>(console.log(e),e);
